{% extends 'base.html' %}

{% block title %}Customer Testing Requests | Unified Science Labs{% endblock %}

{% block content %}

<div class="container my-5">
    {% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
            {% for category, message in messages %}
                {% if category == 'success' %}
                    <div class="alert alert-success mx-5" role="alert">
                        {{ message }}
                    </div>
                {% else %}
                    <div class="alert alert-danger mx-5" role="alert">
                        {{ message }}
                    </div>
                {% endif %}
            {% endfor %}
    {% endif %}
    {% endwith %}
</div>

<div class="container my-5" style="overflow-x: auto;">
    <table id="user_requests_table">
        <thead>
            <tr>
                <th class="text-center align-middle" scope="col">Test Name</th>
                <th class="text-center align-middle" scope="col">Sample Description</th>
                <th class="text-center align-middle" scope="col">Additional Notes</th>
                <th class="text-center align-middle" scope="col">Lab Name</th>
                <th class="text-center align-middle" scope="col" style="width: 15%;">Date/Time Submitted</th>
                <th class="text-center align-middle" scope="col">Current Status</th>
                <th class="text-center align-middle" scope="col">Ship/Purchase</th>
            </tr>
        </thead>

        <tbody>
            {% for my_request, name in my_requests %}
                <tr>
                    <td class="text-center align-middle">{{ my_request.test_name }}</td>
                    <td class="text-center align-middle">{{ my_request.sample_description }}</td>
                    <td class="text-center align-middle">{{ my_request.extra_requirements }}</td>
                    <td class="text-center align-middle">{{ name }}</td>
                    <td class="text-center align-middle">{{ my_request.datetime_submitted }}</td>
                    <td class="text-center align-middle">{{ my_request.approval_status }}</td>
                    <td class="text-center align-middle">
                        <form action="#" method="POST">
                            <input type="hidden" name="pay_type" value="buy_label">
                            <input type="hidden" name="lab_name" value="{{ name }}">
                            <input type="submit" class="btn btn-primary my-1" value="Get Shipping Label">
                        </form>
                        <form action="#" method="POST">
                            <input type="hidden" name="pay_type" value="buy_test">
                            <input type="submit" class="btn btn-primary my-1" value="Purchase Test">
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}